# ğŸ“ Project Structure Guide â€” GTIXT Infrastructure (Feb 26, 2026)

## Executive Summary

After resolving git push issues, we've established a **proper monorepo structure** for GTIXT that ensures:
- âœ… Clean version control (no secrets, no bloat)
- âœ… Efficient CI/CD pipelines
- âœ… Clear separation of concerns
- âœ… Easy team collaboration

---

## Current Structure (CORRECT âœ…)

```
https://github.com/2spi93/gtixt-infrastructure.git
â”‚
â”œâ”€â”€ gpti-site/                 â†’ Next.js Frontend (TypeScript)
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/             â†’ Next.js 13 App Router
â”‚   â”‚   â”œâ”€â”€ components/      â†’ React Components
â”‚   â”‚   â”œâ”€â”€ lib/             â†’ Utilities (db, auth, etc.)
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”œâ”€â”€ .env.local           â†’ âš ï¸ LOCAL ONLY (not versioned)
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ gpti-data-bot/             â†’ Python Backend (Data Extraction)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ gpti_bot/
â”‚   â”‚       â”œâ”€â”€ agents/      â†’ Extraction & Enrichment
â”‚   â”‚       â”œâ”€â”€ db/          â†’ Database layer
â”‚   â”‚       â”œâ”€â”€ llm/         â†’ LLM integrations
â”‚   â”‚       â”œâ”€â”€ extractors/  â†’ Rules, pricing, etc.
â”‚   â”‚       â””â”€â”€ cli/
â”‚   â”œâ”€â”€ scripts/             â†’ Batch operations
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ pyproject.toml
â”‚   â””â”€â”€ .env.local           â†’ âš ï¸ LOCAL ONLY
â”‚
â”œâ”€â”€ gpti-api/                  â†’ Node.js API Server (Optional)
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ .env.local
â”‚
â”œâ”€â”€ docs/                      â†’ Documentation
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ ARCHITECTURE.md
â”‚   â”œâ”€â”€ deployment/           â†’ Deployment guides (NO SECRETS)
â”‚   â”œâ”€â”€ audits/              â†’ Audit reports
â”‚   â””â”€â”€ archive/             â†’ Historical docs
â”‚
â”œâ”€â”€ scripts/                   â†’ DevOps & Utility Scripts
â”‚   â”œâ”€â”€ backup-database.sh
â”‚   â”œâ”€â”€ backup-database.cron
â”‚   â”œâ”€â”€ deploy.sh
â”‚   â””â”€â”€ monitor.sh
â”‚
â”œâ”€â”€ .github/                   â†’ GitHub Actions CI/CD
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ test.yml         â†’ Run tests on PR
â”‚       â”œâ”€â”€ deploy.yml       â†’ Deploy on push to main
â”‚       â””â”€â”€ security.yml     â†’ Security scanning
â”‚
â”œâ”€â”€ .env.example               â†’ Template (versioned, no secrets)
â”œâ”€â”€ .gitignore                 â†’ Ignore rules (150+ patterns)
â”œâ”€â”€ .gitattributes            â†’ Line ending rules
â”œâ”€â”€ README.md                  â†’ Project overview
â””â”€â”€ ARCHITECTURE_OPTIMIZATIONS.md â†’ Performance plan

```

---

## What Gets Versioned (âœ… YES)

### Code & Configuration
- âœ… `*.ts`, `*.tsx` â€” TypeScript source
- âœ… `*.py` â€” Python source
- âœ… `*.yml`, `*.yaml` â€” Docker Compose, k8s configs (NO SECRETS)
- âœ… `*.json` â€” package.json, tsconfig.json (NO SECRETS)
- âœ… `*.md` â€” Documentation

### Dependencies (Files Only, Not node_modules/)
- âœ… `package.json` + `yarn.lock` â€” Frontend dependencies
- âœ… `requirements.txt` â€” Python dependencies (developers run `pip install -r`)
- âœ… `Dockerfile` â€” Container definitions

### Configuration Templates
- âœ… `.env.example` â€” Shows which vars are needed (values are PLACEHOLDERS)
- âœ… `docker-compose.example.yml` â€” Service definitions
- âœ… `.github/workflows/*.yml` â€” CI/CD definitions

### Documentation (No Secrets)
- âœ… `docs/ARCHITECTURE.md` â€” System design
- âœ… `docs/deployment/SETUP.md` â€” How to deploy (generic, no credentials)
- âœ… `docs/API.md` â€” Endpoint documentation

---

## What Does NOT Get Versioned (âŒ NO)

### Secrets & Credentials
- âŒ `.env`, `.env.local` â€” Contains real passwords/API keys
- âŒ `docs/deployment/*CREDENTIALS*.md` â€” Contains real secrets
- âŒ `aws_credentials`, `ssh_keys` â€” Never in git
- âŒ `config/secrets.json` â€” Never in git
- âŒ Anything with: `password=`, `api_key=`, `webhook=`

### Build Artifacts & Dependencies
- âŒ `node_modules/` â€” Generated by `npm install`
- âŒ `dist/`, `build/` â€” Compiled output
- âŒ `.next/` â€” Next.js build cache
- âŒ `venv/`, `__pycache__/` â€” Python virtualenv & compiled files
- âŒ `*.pyc`, `*.pyo` â€” Compiled Python

### System & IDE Files
- âŒ `.vscode/settings.json` â€” IDE preferences (committed: extensions.json only)
- âŒ `.idea/` â€” JetBrains IDE files
- âŒ `.DS_Store` â€” macOS metadata
- âŒ `*.swp`, `*~` â€” Vim swap files

### Logs & Temporary Data
- âŒ `*.log` â€” Application logs
- âŒ `tmp/`, `temp/` â€” Temporary files
- âŒ `coverage/` â€” Test coverage reports (optional in CI)

### Backups & Database Dumps
- âŒ `backups/*.sql.gz` â€” Database backups
- âŒ `backups/**/*.tar.gz` â€” MinIO backups
- âŒ `dumps/` â€” Any database dumps

---

## Environment Management (CRITICAL)

### Development Setup

```bash
# 1. Clone repo
git clone https://github.com/2spi93/gtixt-infrastructure.git
cd gtixt-infrastructure

# 2. Create local env files (FROM EXAMPLES, not from git)
cp .env.example .env.local
cp gpti-site/.env.example gpti-site/.env.local
cp gpti-data-bot/.env.example gpti-data-bot/.env.local

# 3. Edit .env.local files with YOUR local credentials
# These are NEVER committed
nano .env.local

# 4. Install dependencies
npm install --prefix gpti-site
pip install -r gpti-data-bot/requirements.txt

# 5. Run locally
npm run dev --prefix gpti-site         # Frontend on 3000
python3 -m gpti_bot.cli.server         # Backend
```

### Production Deployment

**Option A: Environment Variables**
```bash
# Set on server before starting application
export DATABASE_URL="postgresql://user:pass@prod-db.example.com/gpti"
export SLACK_WEBHOOK="https://hooks.slack.com/services/..."
export MINIO_SECRET_KEY="actual_secret"

# Start application (reads from environment)
npm start --prefix gpti-site
```

**Option B: Systemd Service Files**
```ini
# /etc/systemd/system/gtixt-site.service
[Service]
EnvironmentFile=/etc/gtixt/.env
ExecStart=/usr/bin/npm start --prefix /opt/gtixt/gpti-site
```

**Option C: Docker**
```dockerfile
# Dockerfile
CMD npm start

# docker-compose.yml (CI: pass secrets via CI/CD, never commit)
services:
  web:
    environment:
      - DATABASE_URL=${DATABASE_URL}  # From CI/CD secrets
      - SLACK_WEBHOOK=${SLACK_WEBHOOK}
```

**Option D: CI/CD Secrets (GitHub Actions)**
```yaml
# .github/workflows/deploy.yml
jobs:
  deploy:
    runs-on: ubuntu-latest
    env:
      DATABASE_URL: ${{ secrets.DATABASE_URL }}
      SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
    steps:
      - uses: actions/checkout@v3
      - run: npm install
      - run: npm start  # Reads from env vars above
```

---

## .gitignore Rules

Our `.gitignore` is organized by category:

```gitignore
# 1. Dependencies
node_modules/
venv/
dist/
build/

# 2. Build outputs
.next/
.webpack/

# 3. Environment & secrets
.env
.env.local
.env.*.local

# 4. IDE files
.vscode/
.idea/

# 5. Logs & temp
*.log
tmp/
temp/

# 6. OS files
.DS_Store
Thumbs.db

# 7. Database/backups
backups/
*.sql.gz
*.tar.gz

# 8. CRITICAL: Never commit credentials
*CREDENTIALS*.md
*SLACK*.md
*PRODUCTION*.md
ENV_CONFIGURATION*.md
```

**Always run before committing:**
```bash
# Check what would be committed
git status

# Verify gitignore is working
git check-ignore -v *  # Should show ignored files

# If .env was committed by mistake:
git rm --cached .env
git commit -m "Remove .env from tracking"
```

---

## Repository Health Checks

### Daily (Every Developer)

```bash
# 1. Before committing
git status               # Check for secrets accidentally staged
git diff --cached       # Review what you're committing

# 2. No environment files should be tracked
git status | grep -i env

# 3. No node_modules/ should be tracked
git status | grep node_modules
```

### Weekly (Team Lead)

```bash
# Check git size (should be < 100MB for healthy repo)
du -h .git

# Look for secrets in recent commits
git log -10 --diff-filter=A --name-only -p | grep -i "password\|secret\|key"

# Check if large files were accidentally added
git ls-tree -r HEAD | sort -k4 -nr | head -20
```

### Monthly (DevOps)

```bash
# Full audit for secrets in entire history
git log --all --diff-filter=A -p | grep -E "password|api_key|webhook" | head -20

# Clean up old branches
git branch -a | grep -v "main\|develop"

# Prune unused objects
git gc --aggressive
```

---

## Folder Naming Conventions

### Code Folders (PascalCase in Types, lowercase in files)

**Python:**
```
src/gpti_bot/
â”œâ”€â”€ agents/          â†’ Agent classes (extraction, enrichment)
â”œâ”€â”€ extractors/      â†’ Extractor classes
â”œâ”€â”€ cli/             â†’ Command-line interfaces
â””â”€â”€ db/              â†’ Database models & queries
```

**TypeScript/JavaScript:**
```
src/
â”œâ”€â”€ app/             â†’ Next.js App Router
â”œâ”€â”€ components/      â†’ React Components (PascalCase: Button.tsx)
â”œâ”€â”€ lib/             â†’ Utilities (lowercase: utils.ts)
â””â”€â”€ styles/          â†’ CSS/sass files
```

### Documentation Folders

```
docs/
â”œâ”€â”€ README.md           â†’ Start here
â”œâ”€â”€ ARCHITECTURE.md     â†’ System design
â”œâ”€â”€ API.md              â†’ API documentation
â”œâ”€â”€ deployment/         â†’ How to deploy
â”œâ”€â”€ audits/             â†’ Audit reports
â””â”€â”€ archive/            â†’ Historical documents
```

---

## CI/CD Pipeline Structure

### What Runs on Every PR

```yaml
# .github/workflows/test.yml
on: pull_request
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: npm ci --prefix gpti-site
      - run: npm run build --prefix gpti-site
      - run: npm run test --prefix gpti-site
      - run: pip install -r gpti-data-bot/requirements.txt
      - run: python -m pytest gpti-data-bot/tests
```

### What Runs on Push to main

```yaml
# .github/workflows/deploy.yml
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: npm ci --prefix gpti-site && npm run build
      - run: docker build -t gtixt-web:${{ github.sha }} .
      - run: |
          docker push registry.example.com/gtixt-web:${{ github.sha }}
          # Deploy to production
```

### Security Scanning

```yaml
# .github/workflows/security.yml
on: [push, pull_request]
jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: aquasecurity/trivy-action@master  # Scan for vulnerabilities
      - uses: truffleHog/trufflehog@main        # Detect secrets
```

---

## Best Practices

### âœ… DO

- âœ… **Force .gitignore** on day 1 (not after the fact)
- âœ… **Use .env.example** (commit this, not .env.local)
- âœ… **Small, frequent commits** (`git commit -m "fix: issue #123"`)
- âœ… **Pull before push** (`git pull --rebase`)
- âœ… **Review before committing** (`git diff --cached`)
- âœ… **Use branches** for features (`git checkout -b feature/new-extractor`)

### âŒ DON'T

- âŒ **Commit secrets** (even temporarily)
- âŒ **Commit dependencies** (.next/, node_modules/, venv/)
- âŒ **Force push to main** (only in emergencies)
- âŒ **Large, infrequent commits** (hard to review, hard to revert)
- âŒ **Debug files** (*.swp, *.log, .DS_Store)
- âŒ **Commit build artifacts** (use .gitignore)

---

## Recovery Procedures

### Accidentally Committed .env?

```bash
# IMMEDIATE: Remove from tracking (don't delete local file)
git rm --cached .env
git commit -m "Remove .env from tracking"

# Check if it's in history (CRITICAL!)
git log --all --diff-filter=A -p | grep -i "DATABASE_URL" | head -5

# If found in history: You must rotate all credentials!
# Contact admin for secret reset
```

### Accidentally Committed Files?

```bash
# See what's in git
git ls-tree -r HEAD | grep "huge_file"

# Remove from history
git filter-repo --path huge_file --invert-paths --force

# Force push (WARNING: rewrites history)
git push origin main --force
```

### Git History Too Large?

```bash
# Compact old objects
git gc --aggressive --prune=now

# Check size before/after
du -sh .git
```

---

## Summary: Checklist for New Developers

When joining the team:

- [ ] Clone repo: `git clone https://github.com/2spi93/gtixt-infrastructure.git`
- [ ] Copy env templates: `cp .env.example .env.local`
- [ ] Fill in local credentials in `.env.local`
- [ ] Install dependencies: `npm install && pip install -r requirements.txt`
- [ ] Verify .gitignore: `git check-ignore -v .env* node_modules`
- [ ] Run tests: `npm test`
- [ ] Create feature branch: `git checkout -b feature/my-feature`
- [ ] Commit code (never commit .env or node_modules)
- [ ] Create PR & request review
- [ ] Merge to main once approved

**NEVER:**
- Put credentials in code
- Commit .env, node_modules, or backups
- Force push to main without approval
- Merge unreviewed code

---

**Document Created**: February 26, 2026  
**Repository**: https://github.com/2spi93/gtixt-infrastructure.git  
**Status**: âœ… Healthy & Optimized
